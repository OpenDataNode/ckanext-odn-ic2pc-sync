{% extends 'package/edit_base.html' %}

{% block subtitle %}{{ _('Publishing') }} - {{ h.dataset_display_name(pkg) }}{% endblock %}

{% set controller = 'ckanext.controllers.publishing:PublishingController' %}

{% block styles %}
  {{ super() }}
  {% resource 'publ_theme/publishing.css' %}
{% endblock %}

{% block page_primary_action %}
  {% link_for _('Add catalog'), controller=controller, action='create', id=pkg_dict.name, class_='btn', icon='plus' %}
{% endblock %}

{% block primary_content_inner %}
  <div class="publ_header">List of associated external catalogs</div>
  {% if catalogs %}
  	<table class="publ_catalogs">
  	  <tr>
  	    <th>URL</th>
  	    <th>Type</th>
  	    <th>Authorization</th>
  	    <th>Last update</th>
  	    <th>Action</th>
  	  </tr>
  	  {% for cat in catalogs %}
      <tr>
        <td>{{ cat.url }}</td>
        <td>{{ cat.type }}</td>
        <td>
        {% if cat.authorization_required %}
          {{ _("Yes") }}
        {% else %}
          {{ _("No") }}
        {% endif %}  
        </td>
        <td>TODO</td>
        <td>
          <div class="dropdown btn-group">
		    <a href="#" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
			  <i class="icon-share-alt"></i>
			  {{ _('Action') }}
			  <span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
			  <li>
			    {% link_for _('Edit'), controller=controller, action='edit', id=pkg_dict.name, cat_id=cat.id %}
			  </li>
			  <li>
			    {% link_for _('Delete'), controller=controller, action='delete', id=pkg_dict.name, cat_id=cat.id %}
			  </li>
			</ul>
		  </div>
        </td>
      </tr>
      {% endfor %}
    </table>
  {% else %}
  <p>{{ _('no external catalogs defined') }}</p>
  {% endif %}
{% endblock %}